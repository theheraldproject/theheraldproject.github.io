<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>NonBlockingSecureRandom (herald 2.1.0-beta1 API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../../../jquery/jquery-3.5.1.js"></script>
<script type="text/javascript" src="../../../../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="NonBlockingSecureRandom (herald 2.1.0-beta1 API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":10,"i1":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">io.heraldprox.herald.sensor.datatype.random</a></div>
<h2 title="Class NonBlockingSecureRandom" class="title">Class NonBlockingSecureRandom</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li><a href="RandomSource.html" title="class in io.heraldprox.herald.sensor.datatype.random">io.heraldprox.herald.sensor.datatype.random.RandomSource</a></li>
<li>
<ul class="inheritance">
<li>io.heraldprox.herald.sensor.datatype.random.NonBlockingSecureRandom</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<pre>public class <span class="typeNameLabel">NonBlockingSecureRandom</span>
extends <a href="RandomSource.html" title="class in io.heraldprox.herald.sensor.datatype.random">RandomSource</a></pre>
<div class="block">Non-blocking cryptographically secure random source based on a combination of a time-based
 seed generator, reliable external entropy sources, and non-blocking cryptographic functions.
 - Time-based seed generator uses nanosecond clock sampled at millisecond resolution according
   to thread sleep time which is unpredictable due to wider system processes. This is the same
   concept as the ThreadSeedGenerator random seed source used by SecureRandom.
 - External entropy sources that are known to be plentiful in the target domain include BLE
   MAC address of other devices (usually generated by SecureRandom / UUID), detection time,
   and also call time of random function. All are truly unpredictable. Even when there are
   no other devices in the vicinity, the call time itself is unpredictable like the time-based
   seed generator.
 - SHA-256 cryptographic hashing algorithm is known to generate hashes where the individual
   bits follow a uniform distribution. This function is used to advance the internal state of
   this random source, by hashing a combination of current state and external entropy.

 Algorithm and performance characteristics:
 - 2048 bit seed entropy collected from thread scheduler timing of 1 millisecond at nanosecond resolution
 - Up to 2048 bit external entropy collected from BLE MAC address of target devices and detection time
 - 2048 bit internal state updated by SHA-256 of current state and available external entropy
 - 2048 bit ephemeral state derived from SHA-256 of XOR(previous state, current state)
 - Random bits derived from recursive SHA-256 of XOR(ephemeral state, random output)
 - 6298ns/call to nextLong when the internal state is replaced every second.
 - Distribution test shows solution offers similar characteristics as BlockingSecureRandomNIST
   - BlockingSecureRandomNIST, samples=1000000, sequenceError=0.011800755248335893, valueError=0.0119505
   - NonBlockingSecureRandom,  samples=1000000, sequenceError=0.011930763568868408, valueError=0.0124595
   - BlockingSecureRandom,     samples=1000000, sequenceError=0.01340685803891449,  valueError=0.0125805

 SecureRandom is blocking when it is used on an idle device as entropy is exhausted. The lack
 of system activities mean entropy is not replenished at a required rate, thus causing other
 subsystems that rely on this mechanism for random data to also block, e.g. BLE MAC address
 generation, and halting the app until the device is active again. Experiments have shown even
 a single instantiation of SecureRandom on an idle device is sufficient to cause blocking for
 this app and wider BLE operations. SecureRandom may also block the app on start up, especially
 when the phone was recently booted up. Following numerous investigations and implementations
 of a cryptographically secure random source, the evidence suggests SecureRandom should be
 avoided completely to prevent blocking.

 Please refer to the following paper for a review of entropy sources for SecureRandom

 Michaelis K., Meyer C., Schwenk J. (2013) Randomly Failed! The State of Randomness in Current
 Java Implementations. In: Dawson E. (eds) Topics in Cryptology â€“ CT-RSA 2013. CT-RSA 2013.
 Lecture Notes in Computer Science, vol 7779. Springer, Berlin, Heidelberg.
 https://doi.org/10.1007/978-3-642-36095-4_9

 This new solution addresses previous vulnerabilities by using
 - 2048 bits as internal state
 - SHA256 instead of SHA1 for hashing
 - Single thread for entropy collection
 - Initial entropy collection is blocking
 - Reseeding is non-blocking, thus attack on system load cannot compromise internal state

 Note: Logging has been disabled by commenting to avoid information leakage, only fault
 messages are retained.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<ul class="blockList">
<li class="blockList"><a id="fields.inherited.from.class.io.heraldprox.herald.sensor.datatype.random.RandomSource">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;io.heraldprox.herald.sensor.datatype.random.<a href="RandomSource.html" title="class in io.heraldprox.herald.sensor.datatype.random">RandomSource</a></h3>
<code><a href="RandomSource.html#entropy">entropy</a></code></li>
</ul>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E()">NonBlockingSecureRandom</a></span>()</code></th>
<td class="colLast">
<div class="block">Non-blocking cryptographically secure random source based on recommended reseeding interval
 parameters for pseudo device address generation.</div>
</td>
</tr>
<tr class="rowColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(int,io.heraldprox.herald.sensor.datatype.TimeInterval)">NonBlockingSecureRandom</a></span>&#8203;(int&nbsp;seedBits,
                       <a href="../TimeInterval.html" title="class in io.heraldprox.herald.sensor.datatype">TimeInterval</a>&nbsp;reseedInterval)</code></th>
<td class="colLast">
<div class="block">Non-blocking cryptographically secure random source based on a combination of a time-based
 seed generator, reliable external entropy sources, and non-blocking cryptographic functions.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#nextBytes(byte%5B%5D)">nextBytes</a></span>&#8203;(byte[]&nbsp;bytes)</code></th>
<td class="colLast">
<div class="block">Get random bytes from the random source.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static <a href="../Data.html" title="class in io.heraldprox.herald.sensor.datatype">Data</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#xor(io.heraldprox.herald.sensor.datatype.Data,io.heraldprox.herald.sensor.datatype.Data)">xor</a></span>&#8203;(<a href="../Data.html" title="class in io.heraldprox.herald.sensor.datatype">Data</a>&nbsp;left,
   <a href="../Data.html" title="class in io.heraldprox.herald.sensor.datatype">Data</a>&nbsp;right)</code></th>
<td class="colLast">
<div class="block">XOR function : Compute left xor right, assumes left and right are the same length
 If the left and right data are of different lengths, the function will return
 xor(left, right) up to minimum length.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.io.heraldprox.herald.sensor.datatype.random.RandomSource">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;io.heraldprox.herald.sensor.datatype.random.<a href="RandomSource.html" title="class in io.heraldprox.herald.sensor.datatype.random">RandomSource</a></h3>
<code><a href="RandomSource.html#addEntropy(byte)">addEntropy</a>, <a href="RandomSource.html#addEntropy(long)">addEntropy</a>, <a href="RandomSource.html#addEntropy(java.lang.String)">addEntropy</a>, <a href="RandomSource.html#hash(io.heraldprox.herald.sensor.datatype.Data)">hash</a>, <a href="RandomSource.html#nextInt()">nextInt</a>, <a href="RandomSource.html#nextLong()">nextLong</a>, <a href="RandomSource.html#useEntropy()">useEntropy</a>, <a href="RandomSource.html#useEntropy(int,io.heraldprox.herald.sensor.datatype.Data)">useEntropy</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;(int,io.heraldprox.herald.sensor.datatype.TimeInterval)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>NonBlockingSecureRandom</h4>
<pre>public&nbsp;NonBlockingSecureRandom&#8203;(int&nbsp;seedBits,
                               @NonNull
                               <a href="../TimeInterval.html" title="class in io.heraldprox.herald.sensor.datatype">TimeInterval</a>&nbsp;reseedInterval)</pre>
<div class="block">Non-blocking cryptographically secure random source based on a combination of a time-based
 seed generator, reliable external entropy sources, and non-blocking cryptographic functions.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>seedBits</code> - Number of random bits for seeding the internal state, and also mixing with current state on state update.</dd>
<dd><code>reseedInterval</code> - Time between complete internal state replacement.</dd>
</dl>
</li>
</ul>
<a id="&lt;init&gt;()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>NonBlockingSecureRandom</h4>
<pre>public&nbsp;NonBlockingSecureRandom()</pre>
<div class="block">Non-blocking cryptographically secure random source based on recommended reseeding interval
 parameters for pseudo device address generation. Internal state is fully replaced once
 every 6 hours.</div>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="nextBytes(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>nextBytes</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;nextBytes&#8203;(@NonNull
                      byte[]&nbsp;bytes)</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from class:&nbsp;<code><a href="RandomSource.html#nextBytes(byte%5B%5D)">RandomSource</a></code></span></div>
<div class="block">Get random bytes from the random source.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="RandomSource.html#nextBytes(byte%5B%5D)">nextBytes</a></code>&nbsp;in class&nbsp;<code><a href="RandomSource.html" title="class in io.heraldprox.herald.sensor.datatype.random">RandomSource</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>bytes</code> - Fill byte array with random data.</dd>
</dl>
</li>
</ul>
<a id="xor(io.heraldprox.herald.sensor.datatype.Data,io.heraldprox.herald.sensor.datatype.Data)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>xor</h4>
<pre class="methodSignature">@NonNull
public static&nbsp;<a href="../Data.html" title="class in io.heraldprox.herald.sensor.datatype">Data</a>&nbsp;xor&#8203;(@NonNull
                       <a href="../Data.html" title="class in io.heraldprox.herald.sensor.datatype">Data</a>&nbsp;left,
                       @NonNull
                       <a href="../Data.html" title="class in io.heraldprox.herald.sensor.datatype">Data</a>&nbsp;right)</pre>
<div class="block">XOR function : Compute left xor right, assumes left and right are the same length
 If the left and right data are of different lengths, the function will return
 xor(left, right) up to minimum length.</div>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</body>
</html>
